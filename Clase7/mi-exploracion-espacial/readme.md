Para la escritura de este código, se siguio la sigiente información

1.  https://gist.github.com/heladio-devf-mx/6761648be4a91b72d53b14a48f3fd7c1.